From 2d5e7dbd61dbc10fa9c669dfaf70cb06c40880fa Mon Sep 17 00:00:00 2001
From: Ronan Abhamon <ronan.abhamon@vates.fr>
Date: Thu, 19 Dec 2019 11:01:38 +0100
Subject: [PATCH 04/12] fix(qemuback): use communicate method to wait process
 termination in read call

---
 daemons/qemuback/qemuback.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/daemons/qemuback/qemuback.py b/daemons/qemuback/qemuback.py
index d004766..eafb01e 100755
--- a/daemons/qemuback/qemuback.py
+++ b/daemons/qemuback/qemuback.py
@@ -16,8 +16,8 @@ def watch(path):
 
 def read(path):
     cmd = ["/usr/bin/xenstore-read", path]
-    proc = subprocess.Popen(cmd, stdout=subprocess.PIPE)
-    return proc.stdout.readline().strip()
+    data, _ = subprocess.Popen(cmd, stdout=subprocess.PIPE).communicate()
+    return data.strip()
 
 
 def found_new_qdisk(domid, devid, uuid):
-- 
2.38.1

